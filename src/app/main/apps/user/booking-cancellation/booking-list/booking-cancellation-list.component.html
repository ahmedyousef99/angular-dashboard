<div class="content-wrapper container-xxl p-0">
  <app-content-header [contentHeader]="contentHeader"></app-content-header>

  <div class="content-body">
    <!-- User List -->
    <section class="users-list-wrapper">
      <div class="card">
        <div class="row p-1 justify-content-start align-items-center">
          <div class="col-md-2 col-4">
            <div class="d-flex justify-content-start align-items-center">
              <label class="d-flex align-items-center"
                >Show
                <select
                  (change)="onSelectChange($event)"
                  class="form-control mx-25"
                >
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
                </select>
                entries</label
              >
            </div>
          </div>

          <div
            class="form-group col-md-4 col-8 d-flex flex-column align-items-start"
          >
            <label for="status">Status</label>
            <select
              (change)="onStatusSelect($event.target.value)"
              class="form-control w-100"
              name="status"
              id="status"
            >
              <option value="">All</option>
              <option value="PENDING">Pending</option>
              <option value="DONE">Done</option>
              <option value="REJECTED">Rejected</option>
            </select>
          </div>
        </div>
        <ngx-datatable
          [rows]="rows"
          [rowHeight]="50"
          class="bootstrap core-bootstrap"
          [columnMode]="ColumnMode.force"
          [headerHeight]="50"
          [footerHeight]="50"
          [scrollbarH]="true"
          [externalPaging]="true"
          [limit]="page.size"
          [offset]="page.pageNumber"
          (page)="setPage($event)"
          [count]="comingData?.data.total"
        >
          <ngx-datatable-column name="Actions" [sortable]="false" [width]="50">
            <ng-template ngx-datatable-cell-template let-row="row">
              <div ngbDropdown container="body">
                <button
                  ngbDropdownToggle
                  type="button"
                  class="btn icon-btn btn-sm hide-arrow"
                  rippleEffect
                >
                  <span
                    [data-feather]="'more-vertical'"
                    [class]="'cursor-pointer'"
                  ></span>
                </button>
                <div ngbDropdownMenu>
                  <a
                    routerLink="/apps/user/booking-view/{{ row.id }}"
                    ngbDropdownItem
                    ><span
                      [data-feather]="'file-text'"
                      [size]="16"
                      [class]="'mr-50'"
                    ></span>
                    Details</a
                  ><a (click)="modalOpenForm(modalForm, row.id)" ngbDropdownItem
                    ><span
                      [data-feather]="'edit'"
                      [size]="16"
                      [class]="'mr-50'"
                    ></span>
                    Edit</a
                  ><a
                    (click)="modalOpenWarning(modalWarning, row?.id, row?.name)"
                    href="javascript:;"
                    ngbDropdownItem
                    ><span
                      [data-feather]="'trash'"
                      [size]="16"
                      [class]="'mr-50'"
                    ></span>
                    Delete</a
                  >
                </div>
              </div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Booking ID:" [width]="100">
            <ng-template
              let-row="row"
              let-name="value"
              ngx-datatable-cell-template
            >
              <div class="d-flex align-items-center">
                <div class="cell-line-height">
                  <a
                    routerLink="/apps/user/booking-cancellation-view/{{
                      row?.booking.id
                    }}"
                    class="font-medium-1 d-block"
                    ><span class="font-weight-bold">#{{ row?.id }}</span></a
                  >
                </div>
              </div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Cancelled By" [width]="120">
            <ng-template
              let-row="row"
              let-name="value"
              ngx-datatable-cell-template
            >
              <div class="d-flex align-items-center">
                <div class="cell-line-height">
                  <a class="font-medium-1 d-block"
                    ><span class="font-weight-bold">{{
                      row.submittedByType
                    }}</span></a
                  >
                </div>
              </div>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="Status" prop="status" [width]="90">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <div
                class="badge badge-pill"
                [ngClass]="{
                  'badge-light-success': row?.status == 'DONE',
                  'badge-light-warning': row?.status == 'PENDING',
                  'badge-light-danger': row?.status == 'REJECTED'
                }"
              >
                {{ row?.status }}
              </div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Total Price" [width]="100">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <div>
                <i class="feather font-medium-3"></i>
                {{ row?.booking.totalPrice | currency }}
              </div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="City" [width]="80">
            <ng-template let-row="row" ngx-datatable-cell-template>
              <div>
                <i class="feather font-medium-3"></i>
                {{ row?.booking.city }}
              </div>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="Reason">
            <ng-template
              let-row="row"
              let-name="value"
              ngx-datatable-cell-template
            >
              <div class="d-flex align-items-center">
                <div class="cell-line-height">
                  <a
                    routerLink="/apps/user/booking-cancellation-view/{{
                      row?.id
                    }}"
                    class="font-medium-1 d-block"
                    ><span class="font-weight-bold px-1">{{
                      row?.reason
                    }}</span></a
                  >
                  <!-- routerLink="/apps/user/user-view/{{ row?.customer.id }}" -->
                </div>
              </div>
            </ng-template>
          </ngx-datatable-column>
        </ngx-datatable>
      </div>
    </section>
    <!--/ User List -->
  </div>
</div>
<ng-template #modalWarning let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="myModalLabel160">Delete booking</h5>
    <button
      type="button"
      class="close"
      (click)="modal.dismiss('Cross click')"
      aria-label="Close"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" tabindex="0" ngbAutofocus>
    Are you sure you want to delete this booking
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-warning"
      (click)="onDelete()"
      rippleEffect
    >
      <span *ngIf="!deleteLoader"> Delete </span>
      <div
        *ngIf="deleteLoader"
        style="width: 1rem; height: 1rem"
        class="spinner-border text-light"
        role="status"
      >
        <span class="sr-only">Loading...</span>
      </div>
    </button>
  </div>
</ng-template>
<block-ui> </block-ui>
<ng-template #modalForm let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="myModalLabel1">Booking Update</h4>
    <button
      type="button"
      class="close"
      (click)="modal.dismiss('Cross click')"
      aria-label="Close"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" tabindex="0" ngbAutofocus>
    <form>
      <div class="form-group">
        <label for="status">Status:</label>
        <select
          [formControl]="statusControl"
          class="form-control w-100"
          name="status"
          id="status"
        >
          <option value="PENDING">Pending</option>
          <option value="DONE">Done</option>
          <option value="REJECTED">REJECTED</option>
        </select>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button
      type="submit"
      class="btn btn-primary"
      (click)="onUpdateButton()"
      rippleEffect
    >
      Update Now
    </button>
  </div>
</ng-template>
